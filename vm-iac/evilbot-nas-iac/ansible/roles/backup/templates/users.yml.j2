# Autogenerated by backup role. Declarative user manifest.
users:
{% set passwd = ansible_facts.getent_passwd | default({}) %}
{% set groupdb = ansible_facts.getent_group  | default({}) %}
{% for item in (passwd | dict2items
                | selectattr('value.uid','>=',1000)
                | rejectattr('key','equalto','nobody')) %}
  - name: {{ item.key }}
    uid: {{ item.value.uid }}
    gid: {{ item.value.gid }}
    shell: {{ item.value.shell }}
    home: {{ item.value.dir }}
    groups:
{%   for g in groupdb | dict2items if item.key in (g.value.members | default([])) %}
      - {{ g.key }}
{%   endfor %}
{% endfor %}
